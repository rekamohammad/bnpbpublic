{"version":3,"sources":["menu.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"menu.js","sourcesContent":["var MenuNestable = function () {\n    return {\n        props: {\n            nestable: $('#nestable')\n        },\n        setDataItem: function (target) {\n            target.each(function (index, el) {\n                var current = $(el);\n                current.data('id', current.attr('data-id'));\n                current.data('title', current.attr('data-title'));\n                current.data('related-id', current.attr('data-related-id'));\n                current.data('type', current.attr('data-type'));\n                current.data('custom-url', current.attr('data-custom-url'));\n                current.data('class', current.attr('data-class'));\n                current.data('target', current.attr('data-target'));\n            });\n        },\n        updatePositionForSerializedObj: function (arr_obj) {\n            var result = arr_obj;\n            $.each(result, function (index, val) {\n                val.position = index;\n                if (typeof val.children == 'undefined') {\n                    val.children = [];\n                }\n                MenuNestable.updatePositionForSerializedObj(val.children);\n            });\n            return result;\n        },\n        //main function to initiate the module\n        init: function () {\n            var depth = parseInt(MenuNestable.props.nestable.attr('data-depth'));\n            if (depth < 1) {\n                depth = 5;\n            }\n            $('.nestable-menu').nestable({\n                group: 1,\n                maxDepth: depth,\n                expandBtnHTML: '',\n                collapseBtnHTML: ''\n            });\n        },\n        handleNestableMenu: function () {\n            //Show node details\n            $(document).on('click', '.dd-item .dd3-content a.show-item-details', function (event) {\n                event.preventDefault();\n                var parent = $(this).parent().parent();\n                $(this).toggleClass('active');\n                parent.toggleClass('active');\n            });\n\n            // Edit attr\n            $(document).on('change blur keyup', '.nestable-menu .item-details input[type=\"text\"], .nestable-menu .item-details select', function (event) {\n                event.preventDefault();\n                var current = $(this);\n                var parent = current.closest('li.dd-item');\n                parent.attr('data-' + current.attr('name'), current.val());\n                parent.data(current.attr('name'), current.val());\n                parent.find('> .dd3-content .text[data-update=\"' + current.attr('name') + '\"]').text(current.val());\n                if (current.val().trim() == '') {\n                    parent.find('> .dd3-content .text[data-update=\"' + current.attr('name') + '\"]').text(current.attr('data-old'));\n                }\n                MenuNestable.setDataItem(MenuNestable.props.nestable.find('> ol.dd-list li.dd-item'));\n            });\n\n            // Add nodes\n            $(document).on('click', '.box-links-for-menu .btn-add-to-menu', function (event) {\n                event.preventDefault();\n                var current = $(this);\n                var parent = current.parents('.the-box');\n                var html = '';\n                if (parent.attr('id') == 'external_link') {\n                    var data_type = 'custom-link';\n                    var data_related_id = 0;\n                    var data_title = $('#node-title').val();\n                    var data_url = $('#node-url').val();\n                    var data_css_class = $('#node-css').val();\n                    var data_font_icon = $('#node-icon').val();\n                    var data_target = $('#target').find('option:selected').val();\n                    var url_html = '<label class=\"pad-bot-5\"><span class=\"text pad-top-5 dis-inline-block\" data-update=\"custom-url\">Url</span><input type=\"text\" data-old=\"' + data_url + '\" value=\"' + data_url + '\" name=\"custom-url\"></label>';\n                    html += '<li data-type=\"' + data_type + '\" data-related-id=\"' + data_related_id + '\" data-title=\"' + data_title + '\" data-class=\"' + data_css_class + '\" data-id=\"0\" data-custom-url=\"' + data_url + '\" data-icon-font=\"' + data_font_icon + '\" data-target=\"' + data_target + '\" class=\"dd-item dd3-item\">';\n                    html += '<div class=\"dd-handle dd3-handle\"></div>';\n                    html += '<div class=\"dd3-content\">';\n                    html += '<span class=\"text pull-left\" data-update=\"title\">' + data_title + '</span>';\n                    html += '<span class=\"text pull-right\">' + data_type + '</span>';\n                    html += '<a href=\"#\" class=\"show-item-details\"><i class=\"fa fa-angle-down\"></i></a>';\n                    html += '<div class=\"clearfix\"></div>';\n                    html += '</div>';\n                    html += '<div class=\"item-details\">';\n                    html += '<label class=\"pad-bot-5\">';\n                    html += '<span class=\"text pad-top-5 dis-inline-block\" data-update=\"title\">Title</span>';\n                    html += '<input type=\"text\" data-old=\"' + data_title + '\" value=\"' + data_title + '\" name=\"title\" class=\"form-control\">';\n                    html += '</label>';\n                    html += url_html;\n                    html += '<label class=\"pad-bot-5 dis-inline-block\"><span class=\"text pad-top-5\" data-update=\"icon-font\">Icon - font</span><input type=\"text\" name=\"icon-font\" value=\"' + data_font_icon + '\" data-old=\"' + data_font_icon + '\" class=\"form-control\"></label>';\n                    html += '<label class=\"pad-bot-10\">';\n                    html += '<span class=\"text pad-top-5 dis-inline-block\" data-update=\"class\">CSS class</span>';\n                    html += '<input type=\"text\" data-old=\"' + data_css_class + '\" value=\"' + data_css_class + '\" name=\"class\" class=\"form-control\">';\n                    html += '</label>';\n                    html += '<label class=\"pad-bot-10\">';\n                    html += '<span class=\"text pad-top-5 dis-inline-block\" data-update=\"target\">Target</span>';\n                    html += '<div style=\"width: 228px; display: inline-block\"><select name=\"target\" id=\"target\" data-old=\"' + data_target + '\" class=\"form-control select-full\">';\n                    html += '<option value=\"_self\">Open link directly</option>';\n                    html += '<option value=\"_blank\" ' + (data_target == '_blank' ? 'selected=\"selected\"' : '') + '>Open link in new tab</option>';\n                    html += '</select></div>';\n                    html += '</label>';\n                    html += '<div class=\"text-right\">';\n                    html += '<a class=\"btn red btn-remove\" href=\"#\">Remove</a>';\n                    html += '<a class=\"btn blue btn-cancel\" href=\"#\">Cancel</a>';\n                    html += '</div>';\n                    html += '</div>';\n                    html += '<div class=\"clearfix\"></div>';\n                    html += '</li>';\n                    parent.find('input[type=\"text\"]').val('');\n                } else {\n                    parent.find('.list-item li.active').each(function (index, el) {\n                        var find_in = $(el).find('> label');\n                        var data_type = find_in.attr('data-type');\n                        var data_related_id = find_in.attr('data-related-id');\n                        var data_title = find_in.attr('data-title');\n\n                        html += '<li data-type=\"' + data_type + '\" data-related-id=\"' + data_related_id + '\" data-title=\"' + data_title + '\" data-id=\"0\" data-target=\"_self\" class=\"dd-item dd3-item\">';\n                        html += '<div class=\"dd-handle dd3-handle\"></div>';\n                        html += '<div class=\"dd3-content\">';\n                        html += '<span class=\"text pull-left\" data-update=\"title\">' + data_title + '</span>';\n                        html += '<span class=\"text pull-right\">' + data_type + '</span>';\n                        html += '<a href=\"#\" class=\"show-item-details\"><i class=\"fa fa-angle-down\"></i></a>';\n                        html += '<div class=\"clearfix\"></div>';\n                        html += '</div>';\n                        html += '<div class=\"item-details\">';\n                        html += '<label class=\"pad-bot-5\">';\n                        html += '<span class=\"text pad-top-5 dis-inline-block\" data-update=\"title\">Title</span>';\n                        html += '<input type=\"text\" data-old=\"' + data_title + '\" value=\"' + data_title + '\" name=\"title\" class=\"form-control\">';\n                        html += '</label>';\n                        html += '<label class=\"pad-bot-5 dis-inline-block\"><span class=\"text pad-top-5\" data-update=\"icon-font\">Icon - font</span><input type=\"text\" name=\"icon-font\" class=\"form-control\"></label>';\n                        html += '<label class=\"pad-bot-10\">';\n                        html += '<span class=\"text pad-top-5 dis-inline-block\" data-update=\"class\">CSS class</span>';\n                        html += '<input type=\"text\" name=\"class\" class=\"form-control\">';\n                        html += '</label>';\n                        html += '<label class=\"pad-bot-10\">';\n                        html += '<span class=\"text pad-top-5 dis-inline-block\" data-update=\"target\">Target</span>';\n                        html += '<div style=\"width: 228px; display: inline-block\"><select name=\"target\" id=\"target\" class=\"form-control select-full\">';\n                        html += '<option value=\"_self\">Open link directly</option>';\n                        html += '<option value=\"_blank\">Open link in new tab</option>';\n                        html += '</select></div>';\n                        html += '</label>';\n                        html += '<div class=\"text-right\">';\n                        html += '<a class=\"btn red btn-remove\" href=\"#\">Remove</a>';\n                        html += '<a class=\"btn blue btn-cancel\" href=\"#\">Cancel</a>';\n                        html += '</div>';\n                        html += '</div>';\n                        html += '<div class=\"clearfix\"></div>';\n                        html += '</li>';\n                    });\n                }\n                // Create html\n                $('.nestable-menu > ol.dd-list').append(html);\n\n                $('.nestable-menu').find('.select-full').select2({\n                    width: '100%',\n                    minimumResultsForSearch: -1\n                });\n\n                // Change json\n                MenuNestable.setDataItem(MenuNestable.props.nestable.find('> ol.dd-list li.dd-item'));\n                parent.find('.list-item li.active').removeClass('active');\n            });\n\n            // Remove nodes\n            $('.form-save-menu input[name=\"deleted_nodes\"]').val('');\n            $(document).on('click', '.nestable-menu .item-details .btn-remove', function (event) {\n                event.preventDefault();\n                var current = $(this);\n                var dd_item = current.parents('.item-details').parent();\n\n                var $elm = $('.form-save-menu input[name=\"deleted_nodes\"]');\n                //add id of deleted nodes to delete in controller\n                $elm.val($elm.val() + ' ' + dd_item.attr('data-id'));\n                var children = dd_item.find('> .dd-list').html();\n                if (children != '' && children != null) {\n                    dd_item.before(children);\n                }\n                dd_item.remove();\n            });\n\n            $(document).on('click', '.nestable-menu .item-details .btn-cancel', function (event) {\n                event.preventDefault();\n                var current_pa = $(this);\n                var parent = current_pa.parents('.item-details').parent();\n                parent.find('input[type=\"text\"]').each(function (index, el) {\n                    $(el).val($(el).attr('data-old'));\n                });\n\n                parent.find('select').each(function (index, el) {\n                    $(el).val($(el).val());\n                });\n\n                parent.find('input[type=\"text\"]').trigger('change');\n                parent.find('select').trigger('change');\n                parent.removeClass('active');\n            });\n\n            $(document).on('change', '.box-links-for-menu .list-item li .styled', function () {\n                $(this).closest('li').toggleClass('active');\n            });\n\n            $(document).on('submit', '.form-save-menu', function () {\n                if (MenuNestable.props.nestable.length < 1) {\n                    $('#nestable-output').val('[]');\n                } else {\n                    var nestable_obj_returned = MenuNestable.props.nestable.nestable('serialize');\n                    var the_obj = MenuNestable.updatePositionForSerializedObj(nestable_obj_returned);\n                    $('#nestable-output').val(JSON.stringify(the_obj));\n                }\n            });\n\n            var accordion = $('#accordion');\n\n            function toggleChevron(e) {\n                $(e.target).prev('.widget-heading').find('.narrow-icon').toggleClass('fa-angle-down fa-angle-up');\n            }\n\n            accordion.on('hidden.bs.collapse', toggleChevron);\n            accordion.on('shown.bs.collapse', toggleChevron);\n\n            Botble.callScroll($('.list-item'));\n        }\n    };\n}();\n\n$(window).load(function () {\n    MenuNestable.init();\n    MenuNestable.handleNestableMenu();\n});"]}